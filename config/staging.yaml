# ============================================================================
# InsightSerenity Platform - Staging Configuration
# ============================================================================
# This file contains staging-specific configuration overrides.
# Staging mirrors production but with relaxed settings for testing.
#
# @environment staging
# @version 1.0.0
# ============================================================================

# ----------------------------------------------------------------------------
# Server Configuration - Staging
# ----------------------------------------------------------------------------
server:
  customerServices:
    protocol: https
    trustProxy: true
  
  adminServer:
    protocol: https
    trustProxy: true

# ----------------------------------------------------------------------------
# Database Configuration - Staging
# ----------------------------------------------------------------------------
database:
  connection:
    retryAttempts: 5
    retryDelay: 3000
    healthCheckInterval: 30000

  admin:
    name: insightserenity_admin_staging
    options:
      minPoolSize: 2
      maxPoolSize: 15
      maxIdleTimeMS: 45000
      serverSelectionTimeoutMS: 10000
      socketTimeoutMS: 45000
      writeConcern:
        w: majority
        journal: true

  customer:
    name: insightserenity_customer_staging
    options:
      minPoolSize: 5
      maxPoolSize: 30
      maxIdleTimeMS: 45000
      serverSelectionTimeoutMS: 10000
      socketTimeoutMS: 45000
      writeConcern:
        w: majority
        journal: true

  shared:
    name: insightserenity_shared_staging
    options:
      minPoolSize: 2
      maxPoolSize: 15

# ----------------------------------------------------------------------------
# Authentication - Staging
# ----------------------------------------------------------------------------
auth:
  jwt:
    accessTokenExpiry: 30m
    refreshTokenExpiry: 14d

  password:
    saltRounds: 12
    maxAttempts: 5

# ----------------------------------------------------------------------------
# Security Configuration - Staging
# ----------------------------------------------------------------------------
security:
  helmet:
    enabled: true
    contentSecurityPolicy: true
    hsts:
      maxAge: 15552000  # 180 days

  cors:
    origins:
      - https://staging.insightserenity.com
      - https://staging-admin.insightserenity.com
      - https://staging-api.insightserenity.com

  rateLimit:
    max: 200
    windowMs: 900000

# ----------------------------------------------------------------------------
# Logging Configuration - Staging
# ----------------------------------------------------------------------------
logging:
  level: debug
  format: json
  colorize: false
  prettyPrint: false

  transports:
    console:
      enabled: true
      level: info
    file:
      combined:
        enabled: true
        level: debug
      error:
        enabled: true
      debug:
        enabled: true

  audit:
    enabled: true

# ----------------------------------------------------------------------------
# Caching - Staging
# ----------------------------------------------------------------------------
cache:
  redis:
    enabled: true
    keyPrefix: insightserenity:staging:
    ttl: 1800

  memory:
    enabled: true
    max: 500
    ttl: 180000

# ----------------------------------------------------------------------------
# File Storage - Staging
# ----------------------------------------------------------------------------
storage:
  provider: s3
  
  s3:
    bucket: insightserenity-staging-documents
    region: us-east-1

# ----------------------------------------------------------------------------
# Email - Staging
# ----------------------------------------------------------------------------
email:
  provider: smtp
  from:
    name: InsightSerenity Staging
    address: noreply-staging@insightserenity.com
  
  # In staging, emails go to a catch-all address
  staging:
    enabled: true
    redirectTo: staging-emails@insightserenity.com

# ----------------------------------------------------------------------------
# Health & Monitoring - Staging
# ----------------------------------------------------------------------------
health:
  enabled: true
  checkInterval: 30000

metrics:
  enabled: true
  collectInterval: 10000
  
  prometheus:
    enabled: true
    defaultLabels:
      app: insightserenity
      environment: staging

# ----------------------------------------------------------------------------
# Feature Flags - Staging
# ----------------------------------------------------------------------------
features:
  registration: true
  emailVerification: true
  passwordReset: true
  twoFactorAuth: true
  
  clientManagement: true
  documentManagement: true
  recruitmentServices: true
  hostedOrganizations: true
  
  # Enable for pre-production testing
  analytics: true
  reporting: true
  notifications: true
  realTimeUpdates: true
  
  # Beta features - test in staging
  aiAssistant: true
  advancedSearch: true
  bulkOperations: true

# ----------------------------------------------------------------------------
# Development Tools - Staging
# ----------------------------------------------------------------------------
devTools:
  enabled: true
  
  swagger:
    enabled: true
    path: /api-docs
  
  playground:
    enabled: false
  
  seedData:
    enabled: false
  
  debugRoutes:
    enabled: false

# ----------------------------------------------------------------------------
# Error Handling - Staging
# ----------------------------------------------------------------------------
errors:
  showStack: true
  showDetails: true
  logLevel: debug

# ----------------------------------------------------------------------------
# Scheduled Tasks - Staging
# ----------------------------------------------------------------------------
scheduler:
  enabled: true
  
  jobs:
    cleanup:
      enabled: true
      schedule: "0 2 * * *"
      retentionDays: 30  # Shorter retention in staging
    
    healthReport:
      enabled: true
      schedule: "0 8 * * 1"

# ----------------------------------------------------------------------------
# External Integrations - Staging
# ----------------------------------------------------------------------------
integrations:
  stripe:
    enabled: true
    testMode: true
  
  errorTracking:
    sentry:
      enabled: true
      environment: staging
      tracesSampleRate: 0.5